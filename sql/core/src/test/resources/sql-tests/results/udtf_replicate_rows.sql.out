-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 7


-- !query 0
CREATE TEMPORARY VIEW tab1 AS SELECT * FROM VALUES
    (1, 'row1', 1.1), 
    (2, 'row2', 2.2),
    (0, 'row3', 3.3),
    (-1,'row4', 4.4),
    (null,'row5', 5.5),
    (3, 'row6', null)
    AS tab1(c1, c2, c3)
-- !query 0 schema
struct<>
-- !query 0 output



-- !query 1
SELECT replicate_rows(c1, c2) FROM tab1
-- !query 1 schema
struct<col0:bigint,col1:string>
-- !query 1 output
1	row1
2	row2
2	row2
3	row6
3	row6
3	row6


-- !query 2
SELECT replicate_rows(c1, c2, c2) FROM tab1
-- !query 2 schema
struct<col0:bigint,col1:string,col2:string>
-- !query 2 output
1	row1	row1
2	row2	row2
2	row2	row2
3	row6	row6
3	row6	row6
3	row6	row6


-- !query 3
SELECT replicate_rows(c1, c2, c2, c2, c3) FROM tab1
-- !query 3 schema
struct<col0:bigint,col1:string,col2:string,col3:string,col4:decimal(2,1)>
-- !query 3 output
1	row1	row1	row1	1.1
2	row2	row2	row2	2.2
2	row2	row2	row2	2.2
3	row6	row6	row6	NULL
3	row6	row6	row6	NULL
3	row6	row6	row6	NULL


-- !query 4
SELECT c2, c1
FROM (
  SELECT replicate_rows(c1, c2) AS (c1, c2) FROM tab1
)
-- !query 4 schema
struct<c2:string,c1:bigint>
-- !query 4 output
row1	1
row2	2
row2	2
row6	3
row6	3
row6	3


-- !query 5
SELECT replicate_rows(c1, concat(c2, '...'), c2) FROM tab1
-- !query 5 schema
struct<col0:bigint,col1:string,col2:string>
-- !query 5 output
1	row1...	row1
2	row2...	row2
2	row2...	row2
3	row6...	row6
3	row6...	row6
3	row6...	row6


-- !query 6
DROP VIEW IF EXISTS tab1
-- !query 6 schema
struct<>
-- !query 6 output

